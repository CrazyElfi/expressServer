{% extends "./../layout.njk" %}

{% block stylesheet %}
    <link rel="stylesheet" href="/css/cart.min.css">
{% endblock %}
{% block preScript %}
    <script src="/scripts/cartCalculate.js"></script>
    <script src="/scripts/inputQuantity.js"></script>
    {#    <script src="scripts/cartCheckbox.js"></script>#}
{% endblock %}

{% block content %}
    <div class="cart">
        <div class="container ">
            <h2 class="section-title">Корзина</h2>
            <div class="cart__wrapper">
                <section class="cart__inner">
                    <div class="table">
                        <div class="column-items">
                            <div class="row__menu">
                                <label class="form-check-label cart-action">
                                    <input type="checkbox" class="form-check" onclick="switchAllCheckbox(this)"
                                            {{ "checked" if selectAllStatus }}>
                                    Выбрать все
                                </label>
                                <a class="cart-delete cart-action">Удалить выделенное</a>

                            </div>
                        </div>
                        <h3>Нет в наличии</h3>
                        <div class="column-items">
                            {% for product in productsOutOFStock %}
                                <div class="row row_grid-outstock">
                                    <div class="product-select" data-th="Product">
                                        <input class="form-check-input" type="checkbox" data-id="{{ product.id }}"
                                               onclick="swithOneCheckbox(this)" {{ "checked" if product.checked }}>
                                    </div>

                                    <div class="product-img">
                                        <img src=" {{ product.mURL }}" alt="..." class="img__product img-responsive"/>
                                    </div>

                                    <div class="product-main">
                                        <div class="prod-desc">
                                            <h4>{{ product.name }}</h4>
                                            <p>Нет в наличии</p>
                                        </div>
                                    </div>

                                    <div class="actions" data-th="">
                                        <button class="btn-favorite" data-id="{{ product.id }}">
                                            <img src="images/favorite.png">
                                        </button>
                                        <button href="/cart/{{ product.id }}" data-method="DELETE"
                                                class="btn deleteBtn" onclick="requestRemoveProduct(this)"
                                                data-id="{{ product.id }}">
                                            <img src="images/remove.svg">
                                        </button>
                                    </div>
                                </div>
                            {% endfor %}
                        </div>
                        <h3>В наличии</h3>
                        <div class="column-items">
                            {% for product in productsWithAmount %}
                                {#                        <div class="outOfStock">#}
                                {#                            {% if product.stock == 0 %}#}
                                {#                                {{ product.name }} не в наличии#}
                                {#                            {% endif %}#}
                                {#                        </div>#}

                                {#                        <div class="outOfStock">#}
                                {#                            {% if product.stock > 0 %}#}
                                {#                                {{ product.name }} нормальный товар#}
                                {#                            {% endif %}#}
                                {#                        </div>#}

                                <div class="row row-grid">
                                    <div class="product-select" data-th="Product">
                                        <input class="form-check-input" type="checkbox" data-id="{{ product.id }}"
                                               onclick="swithOneCheckbox(this)" {{ "checked" if product.checked }}>
                                    </div>

                                    <div class="product-img">
                                        <img src=" {{ product.mURL }}" alt="..." class="product-img__img"/>
                                    </div>

                                    <div class="product-main">
                                        <div class="prod-desc">
                                            <h4>{{ product.name }} id: {{ product.id }}</h4>
                                            <p>{{ product.description }}</p>
                                        </div>
                                    </div>

{#                                    <div class="product-price" data-th="Price">#}
{#                                        <span id="price{{ product.id }}"#}
{#                                              data-id="{{ product.id }}"#}
{#                                              class="price"#}
{#        #}{#                                      value="{{ product.sellingPrice }} "#}
{#                                        >{{ product.sellingPrice }} </span>#}
{#                                    </div>#}

                                    <div class="product-qty" data-th="Quantity">
                                        <button class="btnMinus" data-id="{{ product.id }}"
                                                onclick="decreaseAndCalc(this.dataset.id)">-
                                        </button>
                                        <input type="number" data-id="{{ product.id }}" id="input{{ product.id }}"
                                               class="form-control text-center quantityProduct"
                                               value="{{ product.quantity }}"
                                               onchange="reqAndValidationAndCalc(this.dataset.id)" min="0">
                                        <button class="btnPlus" data-id="{{ product.id }}"
                                                onclick="increaseAndCalc(this.dataset.id)">+
                                        </button>
                                    </div>
                                    {% if product.discountRate %}
                                        <div data-th="Subtotal" id="subtotal{{ product.id }}"
                                             data-id="{{ product.id }}"
                                             data-sellingPrice="{{ product.sellingPrice }}"
                                             data-discountRate="{{ product.discountRate }}"
                                             class="subtotal ">
                                            {{ product.rowTotal | addPennies }} |
                                            {{ product.sellingPriceWithDiscount | addPennies }} руб
                                            {{ product.discountInMoney | addPennies }}
                                        </div>
                                    {% else %}
                                        <div data-th="Subtotal" id="subtotal{{ product.id }}"
                                             data-id="{{ product.id }}"
                                             data-price="{{ product.sellingPrice }}"
                                             class="subtotal ">
                                            {{ product.rowTotal }}
                                        </div>
                                    {% endif %}



                                    <div class="actions" data-th="">
                                        <button class="btn-favorite" data-id="{{ product.id }}">
                                            <img src="images/favorite.png">
                                        </button>
                                        <button href="/cart/{{ product.id }}" data-method="DELETE" class="btn deleteBtn" onclick="requestRemoveProduct(this)"
                                                data-id="{{ product.id }}">
                                            <img src="images/remove.svg">
                                        </button>
                                    </div>
                                    <div class="sale">
                                        Sale!!!
                                    </div>
                                </div>

                            {% endfor %}
                        </div>


                    </div>

                </section>

                <section class="order">
                    <div class="result__order">
                        <button class="btn-order">
                            Перейти к оформлению
                        </button>
                        <div class="order-text">
                            Доступные способы и время доставки можно выбрать при оформлении заказа
                        </div>

                        <div class="cart__total">
                            <h4>Ваша корзина</h4>
                            <div class="cart__total-row">
                                <div class="row__column">
                                    Товары ({{ cartLength }})
                                </div>
                                <div id="sumTotal"> {{ sumRowTotal | addPennies }} </div>
                            </div>
                            <div class="cart__total-row row-sale">
                                <div class="row__column">
                                    Скидка
                                </div>
                                <div>{{ sumDiscountInMoney | addPennies }}</div>
                            </div>
                            <div class="cart__total-row">
                                <div class="row__column">
                                    Общая стоимость
                                </div>
                                <div id="sumTotal"> {{ sellingPriceWithDiscount | addPennies}} </div>
                            </div>

                        </div>
                    </div>

                    <div class="bonus">
                        <div class="bonus__header">
                            <h3 class="title">Комплименты</h3>
                            <a class="bonus-btn" href="#">
{#                                Подробнее#}
                                <span class="arrow_down"></span>
                                <span class="arrow_up"></span>
                            </a>
                        </div>
                        <div class="bonus__body">
                            <p class="bonus-text">
                                До бесплатной доставки осталось 492 рубля
                            </p>

                            <div class="progress__bar">
                                <div class="circle">
                                    <span class="label" id="bonusLevel_1">...</span>
                                    <span class="title">Бесплатная доставка от 4 000 рублей</span>
                                </div>
                                <div class="circle">
                                    <span class="label" id="bonusLevel_2">...</span>
                                    <span class="title">Прочая упаковка от 5 000 рублей</span>
                                </div>
                                <div class="circle">
                                    <span class="label" id="bonusLevel_3">...</span>
                                    <span class="title">Эксклюзивная упаковка от 10 000 рублей</span>
                                </div>

                                <div class="progress__line"></div>
                            </div>


                        </div>
                    </div>
                </section>
            </div>


        </div>
    </div>


{% endblock %}
{#<h3 class="">Оформление заказа</h3>#}
{#<form class="form-group">#}
{#    <p>Адрес доставки</p>#}
{#    <div class="input-form">#}
{#        <input type="text" class="form-control input-address" placeholder="Адрес доставки"#}
{#               aria-label="Address" oninput="getAndSendAddress(this)"#}
{#               value="{{ session.order.address }}">#}
{#    </div>#}

{#    <div class="input-form">#}
{#        <input type="text" class="form-control input-phone" placeholder="Номер телефона"#}
{#               aria-label="Phone" onfocusout="getAndSendPhone(this)"#}
{#               value="{{ session.user.phone or session.order.phone }}">#}
{#    </div>#}


{#    <div class="input-group mb-3">#}
{#        <input type="text" class="form-control" placeholder="Введите свое имя"#}
{#               aria-label="Name" onfocusout="getAndSendName(this)" value="{{ session.user.username }}">#}
{#    </div>#}

{#    <div class="input-pay">#}
{#        <h4>Способ оплаты</h4>#}
{#        <div class="">#}
{#            <div class="form-check">#}
{#                <input class="" type="radio" name="gridRadios" id="gridRadios1" value="option1" checked>#}
{#                <label class="form-check-label" for="gridRadios1">#}
{#                    Оплата наличными или банковской картой при получении#}
{#                </label>#}
{#            </div>#}
{#            <div class="form-check">#}
{#                <input class="" type="radio" name="gridRadios" id="gridRadios2" value="option2">#}
{#                <label class="form-check-label" for="gridRadios2">#}
{#                    Онлайн оплата#}
{#                </label>#}
{#            </div>#}

{#        </div>#}
{#    </div>#}
{#    <button class="btn btn-order">#}
{#        <a href="#">Оформить заказ</a>#}
{#    </button>#}
{#</form>#}
